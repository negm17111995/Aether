// TEST 6: Memory Operations
// Tests: malloc, load/store, memory primitives

func main() -> Int {
    // Allocate memory
    let ptr = __builtin_malloc(64)
    if ptr == 0 { return 1 }
    
    // Store and load 8-bit
    __builtin_store8(ptr, 42)
    let val8 = __builtin_load8(ptr)
    if val8 != 42 { return 2 }
    
    // Store and load 64-bit
    __builtin_store64(ptr + 8, 123456789)
    let val64 = __builtin_load64(ptr + 8)
    if val64 != 123456789 { return 3 }
    
    // Test multiple stores
    __builtin_store64(ptr + 16, 100)
    __builtin_store64(ptr + 24, 200)
    __builtin_store64(ptr + 32, 300)
    
    let a = __builtin_load64(ptr + 16)
    let b = __builtin_load64(ptr + 24)
    let c = __builtin_load64(ptr + 32)
    
    if a + b + c != 600 { return 4 }
    
    // Print "OK"
    print(79)
    print(75)
    print(10)
    0
}

func print(c: Int) {
    __builtin_print(c)
}
